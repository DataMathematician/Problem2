# Problem2
## Web-service

<br>file_generator.py - генератор файлов
<br>app.py - соновной исполняемый файл
<br>models.py - содержит модель БД
<br>Реализовано на фреймворке Flask (sqlalchemy - БД)

## Описание
<br>Генерируются несколько файлов большого размера (порядка 1гб.) содержащий целые числа разделенные запятыми (file_generator.py). Был заменен `random.randrange()` на `numpy.random.randint()`, который работает быстрее (на порядок). Файл генерируется в несколько потоков которые генерируют определенный размер данных `file_size/n_process`, где  file_size - размер файла, n_process - кол-во потоков. По завершению генерации, данные от нескольких потоков "сливаются" и передаются в очередь на запись, кэш очищается. Процесс повторяется до тех пор, пока не будут сгенерированы и записаны на диск все файлы (`n_files`).

<br>Далее запускается интерпретатор python:
 * `from app import *`
  * Добавлен класс `Ansvers()` который является временным хранилищем найденных совпадений. Получет данные методом get_values(name,volume), где `name` - имя файла, 'volume' - кол-во вхождений в файл подстроки. После "прохода" по всем файлам, непосредственно перед загрузкой в БД, возвращает данные методом `give_values()`. Затем, просто, итеративно добавляет возвращенные данные в объект `session`. Затем вызывается метод `commit` который и добавляет единоразово все данные полученные объектом `session`
 * `from models import BigData`
 
<br>Запрос к серверу для поиска значения и записи результатов в БД:
 * `client.post('/10)`, где после `/` вводится значение для поиска
<br>В этот момент происходит поиск в папке фсех файлов с расширением `.csv`. Формируется список найденных имен файлов, открывается каждый из файлов, считается кол-во найденных совпадений в файле, записывается в таблицу которая содержит поля: `id`,`name`,`volume` (передаются в таблицу из файла только `name`,`volume`).

<br>Просмотр записей в таблице:
 * `rez = client.get('/)`
 * `rez.get_json()` - выведет все данные в таблице в формате json
<br> ----------------
 * `BigData.qery.all()` - выведет список адресов данных в базе
 * `BigData.qery.get(1).name` - выведет имя записи №1 в таблице (столбец `name`).
 * `BigData.qery.get(1).volume` - выведет кол-во совпадений в файле (столбец `volume`).
 
<br>Для удаления записи из БД:
 * `client.delete('/1')`, где после `/` вводится значение поля `id`, элемент которого нужно удалить (в данном случае `1`)
